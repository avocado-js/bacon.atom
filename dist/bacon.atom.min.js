!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("partial.lenses"),require("infestines"),require("baconjs")):"function"==typeof define&&define.amd?define(["partial.lenses","infestines","baconjs"],n):(e.bacon=e.bacon||{},e.bacon.atom=n(e.L,e.I,e.Bacon))}(this,function(e,n,i){"use strict";function t(e){this.modify(n.always(e))}function s(){var n=this.lens;if(void 0!==n)return e.get(n,this.parent.get())}function o(n){var i=this.lens;void 0!==i&&this.parent.modify(e.modify(i,n))}function u(r){var a=this;return r instanceof i.Observable?a=i.combineWith(r,a,function(n,i){return e.get(a.lens=n,i)}):(a=a.map(e.get(r)).skipDuplicates(n.identicalU)).lens=r,a.parent=this,a.modify=o,a.get=s,a.set=t,a.view=u,a}function r(){return this.value}function a(e){this.bus.push(e)}return function(e){var s=i.Bus(),o=s.scan(e,function(e,n){return o.value=n(e)}).skipDuplicates(n.identicalU);return o.subscribe(n.id),o.value=e,o.bus=s,o.modify=a,o.get=r,o.set=t,o.view=u,o}});
